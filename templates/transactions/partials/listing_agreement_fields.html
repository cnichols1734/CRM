{# 
Listing Agreement Form Fields Partial
This partial is used in both individual document forms and the combined fill-all-docs view.
Variables expected: prefill_data (dict), doc (optional - for field prefixing in combined view)
#}

{% set field_prefix = 'doc_' ~ (doc.id if doc else 'listing') ~ '_field_' %}

<!-- ============================================================== -->
<!-- SECTION 1: PARTIES -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section animate-fade-in-up" data-section="1">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-blue-500 to-blue-600 text-white">1</div>
        <div>
            <h2 class="section-title">Parties</h2>
            <p class="section-subtitle">Seller and property information</p>
        </div>
    </div>
    
    <div class="space-y-6">
        <!-- Seller Information -->
        <div>
            <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                <i class="fas fa-user text-slate-400"></i> Seller Information
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="md:col-span-2">
                    <label class="form-label form-label-required">Seller Full Legal Name(s)</label>
                    <input type="text" name="{{ field_prefix }}seller_legal_name" 
                           value="{{ prefill_data.get('seller_legal_name', prefill_data.get('seller_name', '')) }}"
                           class="premium-input" placeholder="e.g., John Smith and Jane Smith">
                    <p class="help-text">Enter all sellers' full legal names as they appear on the deed.</p>
                </div>
                <div>
                    <label class="form-label form-label-required">Seller Phone</label>
                    <input type="tel" name="{{ field_prefix }}seller_phone" 
                           value="{{ prefill_data.get('seller_phone', '') }}"
                           class="premium-input" placeholder="(555) 123-4567">
                </div>
                <div>
                    <label class="form-label form-label-required">Seller Email</label>
                    <input type="email" name="{{ field_prefix }}seller_email" 
                           value="{{ prefill_data.get('seller_email', '') }}"
                           class="premium-input" placeholder="seller@email.com">
                </div>
            </div>
        </div>

        <!-- Property Address -->
        <div>
            <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                <i class="fas fa-home text-slate-400"></i> Property Address
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="md:col-span-2">
                    <label class="form-label form-label-required">Street Address</label>
                    <input type="text" name="{{ field_prefix }}property_address" 
                           value="{{ prefill_data.get('property_address', '') }}"
                           class="premium-input" readonly>
                </div>
                <div>
                    <label class="form-label form-label-required">City</label>
                    <input type="text" name="{{ field_prefix }}property_city" 
                           value="{{ prefill_data.get('property_city', '') }}"
                           class="premium-input" readonly>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="form-label">State</label>
                        <input type="text" name="{{ field_prefix }}property_state" 
                               value="{{ prefill_data.get('property_state', 'TX') }}"
                               class="premium-input" readonly>
                    </div>
                    <div>
                        <label class="form-label">ZIP</label>
                        <input type="text" name="{{ field_prefix }}property_zip" 
                               value="{{ prefill_data.get('property_zip', '') }}"
                               class="premium-input" readonly>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 2: PROPERTY DETAILS -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="2">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-emerald-500 to-emerald-600 text-white">2</div>
        <div>
            <h2 class="section-title">Property Details</h2>
            <p class="section-subtitle">Legal description and property characteristics</p>
        </div>
    </div>
    
    <div class="space-y-6">
        <!-- Is this a Condo? -->
        <div>
            <label class="form-label form-label-required">Is this property a condominium?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'is_condo', 'yes')">
                    <input type="radio" name="{{ field_prefix }}is_condo" value="yes" 
                           {{ 'checked' if prefill_data.get('is_condo') == 'yes' else '' }}>
                    <span class="option-label">Yes</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'is_condo', 'no')">
                    <input type="radio" name="{{ field_prefix }}is_condo" value="no" 
                           {{ 'checked' if prefill_data.get('is_condo') == 'no' else '' }}>
                    <span class="option-label">No</span>
                </label>
            </div>
            <div class="callout-info" id="condoCallout" style="display: none;">
                <i class="fas fa-info-circle"></i>
                <p>A Condominium Addendum will be automatically added to the document package.</p>
            </div>
        </div>

        <!-- Legal Description -->
        <div>
            <label class="form-label">Legal Description</label>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <input type="text" name="{{ field_prefix }}legal_lot" 
                           value="{{ prefill_data.get('legal_lot', '') }}"
                           class="premium-input" placeholder="Lot">
                </div>
                <div>
                    <input type="text" name="{{ field_prefix }}legal_block" 
                           value="{{ prefill_data.get('legal_block', '') }}"
                           class="premium-input" placeholder="Block">
                </div>
                <div>
                    <input type="text" name="{{ field_prefix }}legal_subdivision" 
                           value="{{ prefill_data.get('legal_subdivision', '') }}"
                           class="premium-input" placeholder="Subdivision">
                </div>
            </div>
            <div class="mt-3">
                <label class="form-label">County</label>
                <input type="text" name="{{ field_prefix }}property_county" 
                       value="{{ prefill_data.get('property_county', '') }}"
                       class="premium-input" placeholder="Enter county">
            </div>
        </div>

        <!-- Exclusions -->
        <div>
            <label class="form-label">Are there any items the seller wants to EXCLUDE from the sale?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'has_exclusions', 'no')">
                    <input type="radio" name="{{ field_prefix }}has_exclusions" value="no" 
                           {{ 'checked' if prefill_data.get('has_exclusions') != 'yes' else '' }}>
                    <span class="option-label">No exclusions</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'has_exclusions', 'yes')">
                    <input type="radio" name="{{ field_prefix }}has_exclusions" value="yes" 
                           {{ 'checked' if prefill_data.get('has_exclusions') == 'yes' else '' }}>
                    <span class="option-label">Yes, there are exclusions</span>
                </label>
            </div>
            <div class="conditional-section" id="exclusionsSection">
                <label class="form-label">List the items to be excluded:</label>
                <textarea name="{{ field_prefix }}exclusions" class="premium-textarea" rows="3" 
                          placeholder="e.g., Refrigerator in garage, chandelier in dining room">{{ prefill_data.get('exclusions', '') }}</textarea>
            </div>
        </div>

        <!-- HOA -->
        <div>
            <label class="form-label form-label-required">Is the property subject to a mandatory HOA?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'has_hoa', 'yes')">
                    <input type="radio" name="{{ field_prefix }}has_hoa" value="yes" 
                           {{ 'checked' if prefill_data.get('has_hoa') == 'yes' or prefill_data.get('intake_has_hoa') == true else '' }}>
                    <span class="option-label">Yes</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'has_hoa', 'no')">
                    <input type="radio" name="{{ field_prefix }}has_hoa" value="no" 
                           {{ 'checked' if prefill_data.get('has_hoa') == 'no' or prefill_data.get('intake_has_hoa') == false else '' }}>
                    <span class="option-label">No</span>
                </label>
            </div>
            <p class="help-text">Includes HOAs, POAs, and any mandatory membership associations.</p>
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 3: LISTING PRICE -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="3">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-green-500 to-green-600 text-white">3</div>
        <div>
            <h2 class="section-title">Listing Price</h2>
            <p class="section-subtitle">Property listing price</p>
        </div>
    </div>
    
    <div>
        <label class="form-label form-label-required">What is the listing price?</label>
        <div class="input-group mt-2">
            <span class="input-prefix">$</span>
            <input type="text" name="{{ field_prefix }}list_price" 
                   value="{{ prefill_data.get('list_price', '') }}"
                   class="premium-input" placeholder="0" 
                   oninput="formatCurrency(this)">
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 4: LISTING TERM -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="4">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-purple-500 to-purple-600 text-white">4</div>
        <div>
            <h2 class="section-title">Listing Term</h2>
            <p class="section-subtitle">Start and end dates for the listing period</p>
        </div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
            <label class="form-label form-label-required">Listing Start Date</label>
            <input type="date" name="{{ field_prefix }}listing_start_date" 
                   value="{{ prefill_data.get('listing_start_date', '') }}"
                   class="premium-input">
        </div>
        <div>
            <label class="form-label form-label-required">Listing End Date</label>
            <input type="date" name="{{ field_prefix }}listing_end_date" 
                   value="{{ prefill_data.get('listing_end_date', '') }}"
                   class="premium-input">
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 5: BROKER COMPENSATION -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="5">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-amber-500 to-amber-600 text-white">5</div>
        <div>
            <h2 class="section-title">Broker Compensation</h2>
            <p class="section-subtitle">Commission structure and buyer agent compensation</p>
        </div>
    </div>
    
    <div class="space-y-6">
        <!-- Primary Decision: Include buyer agent compensation? -->
        <div>
            <label class="form-label form-label-required">Will this listing include compensation offered to a buyer's agent?</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'offer_buyer_agent_comp', 'yes')">
                    <input type="radio" name="{{ field_prefix }}offer_buyer_agent_comp" value="yes" 
                           {{ 'checked' if prefill_data.get('offer_buyer_agent_comp') == 'yes' else '' }}>
                    <div>
                        <span class="option-label">Yes — Use Section 5A</span>
                        <p class="option-description">Seller will pay listing + buyer's agent compensation</p>
                    </div>
                </label>
                <label class="option-card" onclick="selectOption(this, 'offer_buyer_agent_comp', 'no')">
                    <input type="radio" name="{{ field_prefix }}offer_buyer_agent_comp" value="no" 
                           {{ 'checked' if prefill_data.get('offer_buyer_agent_comp') == 'no' else '' }}>
                    <div>
                        <span class="option-label">No — Use Section 5B</span>
                        <p class="option-description">Seller pays listing broker only</p>
                    </div>
                </label>
            </div>
        </div>

        <!-- Section 5A: With Buyer Agent Compensation -->
        <div class="conditional-section" id="section5A">
            <div class="bg-blue-50 rounded-xl p-5 border border-blue-100">
                <h4 class="font-semibold text-blue-900 mb-4 flex items-center gap-2">
                    <i class="fas fa-file-contract text-blue-500"></i> Section 5A: With Buyer Agent Compensation
                </h4>
                
                <div class="space-y-4">
                    <div>
                        <label class="form-label form-label-required">Total compensation paid by seller</label>
                        <p class="text-sm text-slate-600 mb-2">This is the total commission (listing + buyer's agent combined)</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="input-group">
                                <input type="number" name="{{ field_prefix }}total_commission_percent" 
                                       value="{{ prefill_data.get('total_commission_percent', '') }}"
                                       class="premium-input" placeholder="e.g., 6" step="0.01">
                                <span class="input-suffix">%</span>
                            </div>
                            <div class="flex items-center text-slate-400 justify-center">OR</div>
                        </div>
                        <div class="input-group mt-3">
                            <span class="input-prefix">$</span>
                            <input type="text" name="{{ field_prefix }}total_commission_flat" 
                                   value="{{ prefill_data.get('total_commission_flat', '') }}"
                                   class="premium-input" placeholder="Flat fee amount"
                                   oninput="formatCurrency(this)">
                        </div>
                    </div>

                    <div>
                        <label class="form-label">If another broker brings the buyer, how should they be paid?</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                            <div>
                                <label class="text-sm text-slate-600 mb-1 block">Buyer's Agent</label>
                                <div class="input-group">
                                    <input type="number" name="{{ field_prefix }}buyer_agent_percent" 
                                           value="{{ prefill_data.get('buyer_agent_percent', '') }}"
                                           class="premium-input" placeholder="e.g., 3" step="0.01">
                                    <span class="input-suffix">%</span>
                                </div>
                            </div>
                            <div>
                                <label class="text-sm text-slate-600 mb-1 block">— OR Flat Fee —</label>
                                <div class="input-group">
                                    <span class="input-prefix">$</span>
                                    <input type="text" name="{{ field_prefix }}buyer_agent_flat" 
                                           value="{{ prefill_data.get('buyer_agent_flat', '') }}"
                                           class="premium-input" placeholder="Amount"
                                           oninput="formatCurrency(this)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 5B: Without Buyer Agent Compensation -->
        <div class="conditional-section" id="section5B">
            <div class="bg-purple-50 rounded-xl p-5 border border-purple-100">
                <h4 class="font-semibold text-purple-900 mb-4 flex items-center gap-2">
                    <i class="fas fa-file-contract text-purple-500"></i> Section 5B: Listing Broker Only
                </h4>
                
                <div>
                    <label class="form-label form-label-required">Broker's fee paid to Origen Realty</label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-2">
                        <div class="input-group">
                            <input type="number" name="{{ field_prefix }}listing_only_percent" 
                                   value="{{ prefill_data.get('listing_only_percent', '') }}"
                                   class="premium-input" placeholder="e.g., 3" step="0.01">
                            <span class="input-suffix">%</span>
                        </div>
                        <div class="flex items-center text-slate-400 justify-center">OR</div>
                    </div>
                    <div class="input-group mt-3">
                        <span class="input-prefix">$</span>
                        <input type="text" name="{{ field_prefix }}listing_only_flat" 
                               value="{{ prefill_data.get('listing_only_flat', '') }}"
                               class="premium-input" placeholder="Flat fee amount"
                               oninput="formatCurrency(this)">
                    </div>
                </div>
            </div>
        </div>

        <!-- Seller Paying Buyer's Expenses Disclosure -->
        <div class="mt-6 pt-6 border-t border-slate-200">
            <label class="form-label form-label-required">
                Can we tell buyers and other agents that the seller may consider helping with buyer expenses?
            </label>
            <p class="text-sm text-slate-600 mb-3">(closing costs or buyer agent fees)</p>
            
            <div class="callout-info mb-4">
                <i class="fas fa-info-circle"></i>
                <p><strong>This does not obligate the seller to pay anything.</strong> It only controls whether the broker is allowed to disclose that the seller will consider contributing to the buyer's expenses during negotiations.</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <label class="option-card" onclick="selectOption(this, 'authorize_buyer_expense_disclosure', 'yes')">
                    <input type="radio" name="{{ field_prefix }}authorize_buyer_expense_disclosure" value="yes" 
                           {{ 'checked' if prefill_data.get('authorize_buyer_expense_disclosure') == 'yes' else '' }}>
                    <div>
                        <span class="option-label">Yes — Broker may disclose this</span>
                    </div>
                </label>
                <label class="option-card" onclick="selectOption(this, 'authorize_buyer_expense_disclosure', 'no')">
                    <input type="radio" name="{{ field_prefix }}authorize_buyer_expense_disclosure" value="no" 
                           {{ 'checked' if prefill_data.get('authorize_buyer_expense_disclosure') == 'no' else '' }}>
                    <div>
                        <span class="option-label">No — Broker may not disclose this</span>
                    </div>
                </label>
            </div>
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 6: PROTECTION PERIOD -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="6">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-red-500 to-red-600 text-white">6</div>
        <div>
            <h2 class="section-title">Protection Period</h2>
            <p class="section-subtitle">Broker protection after listing ends</p>
        </div>
    </div>
    
    <div class="space-y-4">
        <div>
            <label class="form-label form-label-required">How many days should the protection period be after the listing ends?</label>
            <div class="input-group mt-2" style="max-width: 200px;">
                <input type="number" name="{{ field_prefix }}protection_period_days" 
                       value="{{ prefill_data.get('protection_period_days', '90') }}"
                       class="premium-input" placeholder="90" min="0" max="365">
                <span class="input-suffix">days</span>
            </div>
            <p class="help-text">Common values: 30, 60, or 90 days. This protects the broker if a buyer who viewed the property during the listing period purchases after the listing ends.</p>
        </div>
        
        <div>
            <label class="form-label">County where broker compensation is payable</label>
            <input type="text" name="{{ field_prefix }}compensation_county" 
                   value="{{ prefill_data.get('compensation_county', prefill_data.get('property_county', '')) }}"
                   class="premium-input" placeholder="Defaults to property county">
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 7: MLS & MARKETING -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="7">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-indigo-500 to-indigo-600 text-white">7</div>
        <div>
            <h2 class="section-title">MLS & Marketing</h2>
            <p class="section-subtitle">Public listing and marketing options</p>
        </div>
    </div>
    
    <div class="space-y-6">
        <div>
            <label class="form-label form-label-required">Should this listing be entered into the MLS?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'enter_mls', 'yes')">
                    <input type="radio" name="{{ field_prefix }}enter_mls" value="yes" 
                           {{ 'checked' if prefill_data.get('enter_mls') != 'no' else '' }}>
                    <span class="option-label">Yes</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'enter_mls', 'no')">
                    <input type="radio" name="{{ field_prefix }}enter_mls" value="no" 
                           {{ 'checked' if prefill_data.get('enter_mls') == 'no' else '' }}>
                    <span class="option-label">No</span>
                </label>
            </div>
        </div>

        <!-- MLS Yes Options -->
        <div class="conditional-section" id="mlsYesSection">
            <div>
                <label class="form-label">When should it be entered into the MLS?</label>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-2">
                    <label class="option-card" onclick="selectOption(this, 'mls_timing', 'immediately')">
                        <input type="radio" name="{{ field_prefix }}mls_timing" value="immediately" 
                               {{ 'checked' if prefill_data.get('mls_timing') != 'delayed' else '' }}>
                        <div>
                            <span class="option-label">Immediately</span>
                            <p class="option-description">Per MLS rules</p>
                        </div>
                    </label>
                    <label class="option-card" onclick="selectOption(this, 'mls_timing', 'delayed')">
                        <input type="radio" name="{{ field_prefix }}mls_timing" value="delayed" 
                               {{ 'checked' if prefill_data.get('mls_timing') == 'delayed' else '' }}>
                        <div>
                            <span class="option-label">Delay entry</span>
                            <p class="option-description">Specify days and reason</p>
                        </div>
                    </label>
                </div>
            </div>
            
            <div class="conditional-section" id="mlsDelaySection">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <div>
                        <label class="form-label">Delay for how many days?</label>
                        <input type="number" name="{{ field_prefix }}mls_delay_days" 
                               value="{{ prefill_data.get('mls_delay_days', '') }}"
                               class="premium-input" placeholder="e.g., 7">
                    </div>
                    <div>
                        <label class="form-label">Reason for delay</label>
                        <input type="text" name="{{ field_prefix }}mls_delay_reason" 
                               value="{{ prefill_data.get('mls_delay_reason', '') }}"
                               class="premium-input" placeholder="e.g., Seller preparing property">
                    </div>
                </div>
            </div>
        </div>

        <!-- MLS No Warning -->
        <div class="conditional-section" id="mlsNoSection">
            <div class="callout-warning">
                <i class="fas fa-exclamation-triangle"></i>
                <div>
                    <p><strong>Seller acknowledges:</strong> The property will not be publicly marketed. This may reduce exposure and potentially affect the sale price and time on market.</p>
                    <label class="flex items-center gap-3 mt-3 cursor-pointer">
                        <input type="checkbox" name="{{ field_prefix }}mls_no_acknowledge" value="yes" 
                               class="w-5 h-5 accent-amber-600"
                               {{ 'checked' if prefill_data.get('mls_no_acknowledge') == 'yes' else '' }}>
                        <span class="text-amber-900 font-medium">Seller acknowledges and accepts this</span>
                    </label>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 8: ACCESS & SHOWINGS -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="8">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-cyan-500 to-cyan-600 text-white">8</div>
        <div>
            <h2 class="section-title">Access & Showings</h2>
            <p class="section-subtitle">Property access and showing arrangements</p>
        </div>
    </div>
    
    <div class="space-y-6">
        <div>
            <label class="form-label">Authorize showings and access to the property?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'authorize_showings', 'yes')">
                    <input type="radio" name="{{ field_prefix }}authorize_showings" value="yes" 
                           {{ 'checked' if prefill_data.get('authorize_showings') != 'no' else '' }}>
                    <span class="option-label">Yes</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'authorize_showings', 'no')">
                    <input type="radio" name="{{ field_prefix }}authorize_showings" value="no" 
                           {{ 'checked' if prefill_data.get('authorize_showings') == 'no' else '' }}>
                    <span class="option-label">No</span>
                </label>
            </div>
        </div>

        <div>
            <label class="form-label">Scheduling service to be used (if any)</label>
            <input type="text" name="{{ field_prefix }}scheduling_service" 
                   value="{{ prefill_data.get('scheduling_service', '') }}"
                   class="premium-input" placeholder="e.g., ShowingTime, CSS">
        </div>

        <div>
            <label class="form-label">Authorize use of a lockbox?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'authorize_lockbox', 'yes')">
                    <input type="radio" name="{{ field_prefix }}authorize_lockbox" value="yes" 
                           {{ 'checked' if prefill_data.get('authorize_lockbox') != 'no' else '' }}>
                    <span class="option-label">Yes</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'authorize_lockbox', 'no')">
                    <input type="radio" name="{{ field_prefix }}authorize_lockbox" value="no" 
                           {{ 'checked' if prefill_data.get('authorize_lockbox') == 'no' else '' }}>
                    <span class="option-label">No</span>
                </label>
            </div>
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 9: INTERMEDIARY -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="9">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-violet-500 to-violet-600 text-white">9</div>
        <div>
            <h2 class="section-title">Intermediary</h2>
            <p class="section-subtitle">Dual agency authorization</p>
        </div>
    </div>
    
    <div>
        <label class="form-label form-label-required">May Origen Realty act as an intermediary if representing both buyer and seller?</label>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-2">
            <label class="option-card" onclick="selectOption(this, 'authorize_intermediary', 'yes')">
                <input type="radio" name="{{ field_prefix }}authorize_intermediary" value="yes" 
                       {{ 'checked' if prefill_data.get('authorize_intermediary') != 'no' else '' }}>
                <div>
                    <span class="option-label">Yes — Intermediary authorized</span>
                    <p class="option-description">Broker may represent both parties</p>
                </div>
            </label>
            <label class="option-card" onclick="selectOption(this, 'authorize_intermediary', 'no')">
                <input type="radio" name="{{ field_prefix }}authorize_intermediary" value="no" 
                       {{ 'checked' if prefill_data.get('authorize_intermediary') == 'no' else '' }}>
                <div>
                    <span class="option-label">No — Do not show to Origen buyers</span>
                    <p class="option-description">Property not shown to broker's buyer clients</p>
                </div>
            </label>
        </div>
        <p class="help-text">If "No" is selected, Origen agents cannot show this property to their buyer clients.</p>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 10: INTERNET DISPLAY -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="10">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-pink-500 to-pink-600 text-white">10</div>
        <div>
            <h2 class="section-title">Internet Display</h2>
            <p class="section-subtitle">Online marketing options</p>
        </div>
    </div>
    
    <div class="space-y-6">
        <div>
            <label class="form-label">Allow this listing to be displayed on the internet?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'internet_display', 'yes')">
                    <input type="radio" name="{{ field_prefix }}internet_display" value="yes" 
                           {{ 'checked' if prefill_data.get('internet_display') != 'no' else '' }}>
                    <span class="option-label">Yes</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'internet_display', 'no')">
                    <input type="radio" name="{{ field_prefix }}internet_display" value="no" 
                           {{ 'checked' if prefill_data.get('internet_display') == 'no' else '' }}>
                    <span class="option-label">No</span>
                </label>
            </div>
        </div>

        <div class="conditional-section" id="internetYesSection">
            <div>
                <label class="form-label">Display the property address online?</label>
                <div class="grid grid-cols-2 gap-3 mt-2">
                    <label class="option-card" onclick="selectOption(this, 'display_address_online', 'yes')">
                        <input type="radio" name="{{ field_prefix }}display_address_online" value="yes" 
                               {{ 'checked' if prefill_data.get('display_address_online') != 'no' else '' }}>
                        <span class="option-label">Yes</span>
                    </label>
                    <label class="option-card" onclick="selectOption(this, 'display_address_online', 'no')">
                        <input type="radio" name="{{ field_prefix }}display_address_online" value="no" 
                               {{ 'checked' if prefill_data.get('display_address_online') == 'no' else '' }}>
                        <span class="option-label">No</span>
                    </label>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 11: FINANCING OPTIONS -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="11">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-teal-500 to-teal-600 text-white">11</div>
        <div>
            <h2 class="section-title">Financing Options</h2>
            <p class="section-subtitle">Acceptable financing types</p>
        </div>
    </div>
    
    <div>
        <label class="form-label">Which financing types should be advertised? <span class="text-slate-400 font-normal">(select all that apply)</span></label>
        <div class="checkbox-grid mt-3">
            {% set financing_options = [
                ('conventional', 'Conventional'),
                ('fha', 'FHA'),
                ('va', 'VA'),
                ('cash', 'Cash'),
                ('tx_vet', 'Texas Veterans Land Program'),
                ('owner_financing', 'Owner Financing'),
                ('other', 'Other')
            ] %}
            {% for value, label in financing_options %}
            <label class="checkbox-item" onclick="toggleCheckbox(this)">
                <input type="checkbox" name="{{ field_prefix }}financing_{{ value }}" value="yes"
                       {{ 'checked' if prefill_data.get('financing_' + value) == 'yes' else '' }}>
                <span>{{ label }}</span>
            </label>
            {% endfor %}
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 12: SELLER REPRESENTATIONS -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="12">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-rose-500 to-rose-600 text-white">12</div>
        <div>
            <h2 class="section-title">Seller Representations</h2>
            <p class="section-subtitle">Property condition and disclosures</p>
        </div>
    </div>
    
    <div class="space-y-6">
        <div>
            <label class="form-label">Any known unpaid liens or encumbrances on the property?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'has_liens', 'no')">
                    <input type="radio" name="{{ field_prefix }}has_liens" value="no" 
                           {{ 'checked' if prefill_data.get('has_liens') != 'yes' else '' }}>
                    <span class="option-label">No</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'has_liens', 'yes')">
                    <input type="radio" name="{{ field_prefix }}has_liens" value="yes" 
                           {{ 'checked' if prefill_data.get('has_liens') == 'yes' else '' }}>
                    <span class="option-label">Yes</span>
                </label>
            </div>
            <div class="conditional-section" id="liensSection">
                <label class="form-label">Please explain:</label>
                <textarea name="{{ field_prefix }}liens_explanation" class="premium-textarea" rows="2">{{ prefill_data.get('liens_explanation', '') }}</textarea>
            </div>
        </div>

        <div>
            <label class="form-label">Any delinquent loans, taxes, or HOA dues?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'has_delinquencies', 'no')">
                    <input type="radio" name="{{ field_prefix }}has_delinquencies" value="no" 
                           {{ 'checked' if prefill_data.get('has_delinquencies') != 'yes' else '' }}>
                    <span class="option-label">No</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'has_delinquencies', 'yes')">
                    <input type="radio" name="{{ field_prefix }}has_delinquencies" value="yes" 
                           {{ 'checked' if prefill_data.get('has_delinquencies') == 'yes' else '' }}>
                    <span class="option-label">Yes</span>
                </label>
            </div>
            <div class="conditional-section" id="delinquenciesSection">
                <label class="form-label">Please explain:</label>
                <textarea name="{{ field_prefix }}delinquencies_explanation" class="premium-textarea" rows="2">{{ prefill_data.get('delinquencies_explanation', '') }}</textarea>
            </div>
        </div>

        <div>
            <label class="form-label">Is the property located in any special districts (MUD, PID, etc.)?</label>
            <div class="grid grid-cols-2 gap-3 mt-2">
                <label class="option-card" onclick="selectOption(this, 'has_special_districts', 'no')">
                    <input type="radio" name="{{ field_prefix }}has_special_districts" value="no" 
                           {{ 'checked' if prefill_data.get('has_special_districts') != 'yes' else '' }}>
                    <span class="option-label">No</span>
                </label>
                <label class="option-card" onclick="selectOption(this, 'has_special_districts', 'yes')">
                    <input type="radio" name="{{ field_prefix }}has_special_districts" value="yes" 
                           {{ 'checked' if prefill_data.get('has_special_districts') == 'yes' or prefill_data.get('intake_special_districts') == true else '' }}>
                    <span class="option-label">Yes</span>
                </label>
            </div>
            <div class="conditional-section" id="specialDistrictsSection">
                <label class="form-label">List the special districts:</label>
                <textarea name="{{ field_prefix }}special_districts_list" class="premium-textarea" rows="2" 
                          placeholder="e.g., Cinco MUD 1, Harris County Improvement District 5">{{ prefill_data.get('special_districts_list', '') }}</textarea>
            </div>
        </div>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 13: SPECIAL PROVISIONS -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="13">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-slate-600 to-slate-700 text-white">13</div>
        <div>
            <h2 class="section-title">Special Provisions</h2>
            <p class="section-subtitle">Additional terms and conditions</p>
        </div>
    </div>
    
    <div>
        <label class="form-label">Any special provisions or custom terms to include?</label>
        <textarea name="{{ field_prefix }}special_provisions" class="premium-textarea" rows="4" 
                  placeholder="Enter any additional terms, conditions, or agreements...">{{ prefill_data.get('special_provisions', '') }}</textarea>
        <p class="help-text">This is where you can add any custom agreements not covered elsewhere in the form.</p>
    </div>
</div>

<!-- ============================================================== -->
<!-- SECTION 14: FIRPTA (Foreign Seller) -->
<!-- ============================================================== -->
<div class="premium-card p-6 mb-6 form-section" data-section="14">
    <div class="section-header">
        <div class="section-number bg-gradient-to-br from-orange-600 to-red-600 text-white">14</div>
        <div>
            <h2 class="section-title">Foreign Seller (FIRPTA)</h2>
            <p class="section-subtitle">Tax withholding requirements</p>
        </div>
    </div>
    
    <div>
        <label class="form-label form-label-required">Is the seller considered a "foreign person" for U.S. tax purposes?</label>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-2">
            <label class="option-card" onclick="selectOption(this, 'is_foreign_seller', 'no')">
                <input type="radio" name="{{ field_prefix }}is_foreign_seller" value="no" 
                       {{ 'checked' if prefill_data.get('is_foreign_seller') == 'no' else '' }}>
                <span class="option-label">No</span>
            </label>
            <label class="option-card" onclick="selectOption(this, 'is_foreign_seller', 'yes')">
                <input type="radio" name="{{ field_prefix }}is_foreign_seller" value="yes" 
                       {{ 'checked' if prefill_data.get('is_foreign_seller') == 'yes' else '' }}>
                <span class="option-label">Yes</span>
            </label>
            <label class="option-card" onclick="selectOption(this, 'is_foreign_seller', 'not_sure')">
                <input type="radio" name="{{ field_prefix }}is_foreign_seller" value="not_sure" 
                       {{ 'checked' if prefill_data.get('is_foreign_seller') == 'not_sure' else '' }}>
                <span class="option-label">Not Sure</span>
            </label>
        </div>
        
        <div class="conditional-section" id="firptaWarningSection">
            <div class="callout-warning">
                <i class="fas fa-exclamation-triangle"></i>
                <p>If the seller is a foreign person, FIRPTA (Foreign Investment in Real Property Tax Act) withholding may apply. The seller should consult with a tax professional before closing.</p>
            </div>
        </div>
    </div>
</div>


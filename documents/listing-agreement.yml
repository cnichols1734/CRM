# =============================================================================
# LISTING AGREEMENT
# =============================================================================
# Texas Listing Agreement - form-driven document with custom fill UI
#
# DocuSeal Template ID: 2468023
# 4 Roles: System (auto-complete), Seller, Seller 2 (optional), Broker (agent signs)
# =============================================================================

schema_version: "1.0"
slug: listing-agreement
name: "Listing Agreement"
docuseal_template_id: 2468023
type: form-driven

display:
  color: "#F97316"
  icon: "fas fa-file-contract"
  sort_order: 1

form:
  template: listing_agreement_form.html
  partial: listing_agreement_fields.html

# =============================================================================
# ROLES
# =============================================================================
# - System: All readonly fields, auto-populated from form/transaction/user/org
# - Seller: Pre-filled contact info + manual initials/signature/date
# - Seller 2: Optional, only if co-seller exists
# - Broker: Agent initials/signs (no auto_complete)
# =============================================================================

roles:
  - role_key: system
    docuseal_role: "System"
    email_source: user.email
    name_source: user.full_name
    auto_complete: true

  - role_key: seller
    docuseal_role: "Seller"
    email_source: transaction.primary_seller.display_email
    name_source: transaction.primary_seller.display_name

  - role_key: seller_2
    docuseal_role: "Seller 2"
    email_source: transaction.sellers[1].display_email
    name_source: transaction.sellers[1].display_name
    optional: true

  - role_key: broker
    docuseal_role: "Broker"
    email_source: user.email
    name_source: user.full_name

# =============================================================================
# FIELDS - System Role (79 fields, all pre-populated)
# =============================================================================

fields:
  # --- Brokerage Info (pg1) ---
  - field_key: broker_name
    docuseal_field: "Broker name"
    role_key: system
    source: static:Origen Realty

  - field_key: broker_address
    docuseal_field: "Broker address"
    role_key: system
    source: organization.broker_address

  - field_key: broker_city_state_zip
    docuseal_field: "Broker city/state/zip"
    role_key: system
    source: organization.broker_address

  - field_key: broker_phone
    docuseal_field: "Broker phone"
    role_key: system
    source: static:(832) 419-0296

  - field_key: broker_email_fax
    docuseal_field: "Broker email/fax"
    role_key: system
    source: static:cassie@origenrealty.com

  - field_key: broker_email_fax_2
    docuseal_field: "Broker email/fax 2"
    role_key: system
    source: user.email

  # --- Property Info (pg1) ---
  - field_key: property_lot
    docuseal_field: "Property: Lot number"
    role_key: system
    source: form.legal_lot

  - field_key: property_block
    docuseal_field: "Property: Block number"
    role_key: system
    source: form.legal_block

  - field_key: property_subdivision
    docuseal_field: "Property: Subdivision/Legal Description"
    role_key: system
    source: form.legal_subdivision

  - field_key: property_subdivision_cont
    docuseal_field: "Property: Subdivision/Legal Description Cont."
    role_key: system
    source: null

  - field_key: property_city
    docuseal_field: "Property: City Of"
    role_key: system
    source: form.property_city

  - field_key: property_county
    docuseal_field: "Property: County"
    role_key: system
    source: form.property_county

  - field_key: property_name_address_zip
    docuseal_field: "Property: Property name (Address, Zip)"
    role_key: system
    sources:
      - form.property_address
      - form.property_zip
    template: "{0}, {1}"

  - field_key: property_name_address_zip_cont
    docuseal_field: "Property: Property name\u00A0(Address, Zip) Cont."
    role_key: system
    source: null

  # --- Exclusions (pg1) ---
  - field_key: items_to_remove
    docuseal_field: "Items to remove"
    role_key: system
    source: form.exclusions

  - field_key: hoa_exclusion_is
    docuseal_field: "HOA Exclusion (Is)"
    role_key: system
    source: static:X
    condition_field: form.has_hoa
    condition_equals: "yes"

  - field_key: hoa_exclusion_is_not
    docuseal_field: "HOA Exclusion (Is Not)"
    role_key: system
    source: static:X
    condition_field: form.has_hoa
    condition_equals: "no"

  # --- Listing Concerning (pg2-11) - property identifier on each page ---
  - field_key: listing_concerning_pg2
    docuseal_field: "Listing Concerning pg2"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg3
    docuseal_field: "Listing Concerning pg 3"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg4
    docuseal_field: "Listing Concerning pg 4"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg5
    docuseal_field: "Listing Concerning pg 5"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg6
    docuseal_field: "Listing Concerning pg 6"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg7
    docuseal_field: "Listing Concerning pg 7"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg8
    docuseal_field: "Listing Concerning pg 8"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg9
    docuseal_field: "Listing Concerning pg 9"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg10
    docuseal_field: "Listing Concerning pg 10"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  - field_key: listing_concerning_pg11
    docuseal_field: "Listing Concerning pg 11"
    role_key: system
    sources:
      - form.property_address
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1}, {2} {3}"

  # --- Listing Terms (pg2) ---
  - field_key: listing_price
    docuseal_field: "Listing price"
    role_key: system
    source: form.list_price
    transform: currency

  - field_key: listing_start_date
    docuseal_field: "Listing start date"
    role_key: system
    source: form.listing_start_date
    transform: date_short

  - field_key: listing_end_date
    docuseal_field: "Listing end date"
    role_key: system
    source: form.listing_end_date
    transform: date_short

  # --- Commission Section 5A (with buyer agent compensation) ---
  - field_key: compensation_option_a
    docuseal_field: "5A(1) Compensation option A"
    role_key: system
    source: form.total_commission
    transform: checkbox
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "yes"

  - field_key: commission_percent
    docuseal_field: "5A(1) Commission percent"
    role_key: system
    source: form.total_commission
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "yes"

  - field_key: flat_fee_amount
    docuseal_field: "5A(1) Flat fee amount"
    role_key: system
    source: null

  - field_key: other_compensation_detail
    docuseal_field: "5A(1) Other compensation detail"
    role_key: system
    source: null

  - field_key: compensation_option_b
    docuseal_field: "5A(1) Compensation option B"
    role_key: system
    source: null

  - field_key: other_broker_percent
    docuseal_field: "5A(2)Other broker % share"
    role_key: system
    source: form.buyer_agent_percent
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "yes"

  - field_key: other_broker_flat_fee
    docuseal_field: "5A(2) Other broker flat fee"
    role_key: system
    source: form.buyer_agent_flat
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "yes"

  # --- Commission Section 5B (listing broker only) ---
  - field_key: broker_fee_option_a
    docuseal_field: "5B (1) Broker fee option a"
    role_key: system
    source: form.listing_only_percent
    transform: checkbox
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "no"

  - field_key: broker_fee_percent
    docuseal_field: "5B (1) Broker fee percent"
    role_key: system
    source: form.listing_only_percent
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "no"

  - field_key: broker_fee_option_b
    docuseal_field: "5B (1) Broker fee option B"
    role_key: system
    source: form.listing_only_flat
    transform: checkbox
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "no"

  - field_key: broker_flat_fee
    docuseal_field: "5B (1) Broker flat fee"
    role_key: system
    source: form.listing_only_flat
    condition_field: form.offer_buyer_agent_comp
    condition_equals: "no"

  - field_key: other_broker_fee_detail_b
    docuseal_field: "5B (1) Other broker fee detail B"
    role_key: system
    source: null

  # --- Buyer Expense Disclosure (pg2) ---
  - field_key: disclosure_does
    docuseal_field: "Disclosure: seller paying buyer authorization (does)"
    role_key: system
    source: static:X
    condition_field: form.authorize_buyer_expense_disclosure
    condition_equals: "yes"

  - field_key: disclosure_does_not
    docuseal_field: "Disclosure: seller paying buyer authorization (does not)"
    role_key: system
    source: static:X
    condition_field: form.authorize_buyer_expense_disclosure
    condition_equals: "no"

  # --- Protection Period (pg3) ---
  - field_key: other_fees_expenses
    docuseal_field: "Other fees/expenses"
    role_key: system
    source: null

  - field_key: other_fees_detail
    docuseal_field: "Other fees detail"
    role_key: system
    source: null

  - field_key: protection_period_days
    docuseal_field: "Protection period days"
    role_key: system
    source: form.protection_period_days

  # --- MLS Options (pg4) ---
  - field_key: mls_filing_option_1a
    docuseal_field: "Mls filing option 1 (a)"
    role_key: system
    source: static:X
    condition_field: form.mls_timing
    condition_equals: "immediately"

  - field_key: mls_filing_option_1b
    docuseal_field: "Mls filing option 1 (b)"
    role_key: system
    source: static:X
    condition_field: form.mls_timing
    condition_equals: "delayed"

  - field_key: mls_filing_option_2
    docuseal_field: "Mls filing option 2"
    role_key: system
    source: static:X
    condition_field: form.enter_mls
    condition_equals: "no"

  - field_key: county_payment_location
    docuseal_field: "County payment location"
    role_key: system
    source: form.compensation_county

  - field_key: county_name
    docuseal_field: "County name"
    role_key: system
    source: form.compensation_county

  - field_key: mls_delay_days
    docuseal_field: "MLS Delay days"
    role_key: system
    source: form.mls_delay_days
    condition_field: form.mls_timing
    condition_equals: "delayed"

  - field_key: purpose_of_delay
    docuseal_field: "Purpose of delay"
    role_key: system
    source: form.mls_delay_reason
    condition_field: form.mls_timing
    condition_equals: "delayed"

  - field_key: additional_purpose_of_delay
    docuseal_field: "Additional purpose of delay info"
    role_key: system
    source: null

  # --- Access/Showings (pg5) ---
  - field_key: showing_service_name
    docuseal_field: "Showing Service Name"
    role_key: system
    source: form.scheduling_service

  - field_key: keybox_authorization_is
    docuseal_field: "1. Keybox authorization (is)"
    role_key: system
    source: static:X
    condition_field: form.authorize_lockbox
    condition_equals: "yes"

  - field_key: keybox_authorization_is_not
    docuseal_field: "1. Keybox authorization (is not)"
    role_key: system
    source: static:X
    condition_field: form.authorize_lockbox
    condition_equals: "no"

  # --- Intermediary (pg6) ---
  - field_key: intermediary_option_a
    docuseal_field: "Intermediary option A"
    role_key: system
    source: static:X
    condition_field: form.authorize_intermediary
    condition_equals: "yes"

  - field_key: intermediary_option_b
    docuseal_field: "Intermediary option B"
    role_key: system
    source: static:X
    condition_field: form.authorize_intermediary
    condition_equals: "no"

  # --- Internet Display (pg7) ---
  - field_key: internet_display_does_not
    docuseal_field: "Internet display (does not)"
    role_key: system
    source: static:X
    condition_field: form.internet_display
    condition_equals: "no"

  - field_key: internet_display_address_does_not
    docuseal_field: "Internet display Address (does not)"
    role_key: system
    source: static:X
    condition_field: form.display_address_online
    condition_equals: "no"

  # --- Financing Options (pg7-8) ---
  - field_key: financing_conventional
    docuseal_field: "Financing options (Conventional)"
    role_key: system
    source: static:X
    condition_field: form.financing_conventional
    condition_equals: "yes"

  - field_key: financing_va
    docuseal_field: "Financing options (VA)"
    role_key: system
    source: static:X
    condition_field: form.financing_va
    condition_equals: "yes"

  - field_key: financing_owner_financing
    docuseal_field: "Financing options (owner financing)"
    role_key: system
    source: static:X
    condition_field: form.financing_owner_financing
    condition_equals: "yes"

  - field_key: financing_fha
    docuseal_field: "Financing options (FHA)"
    role_key: system
    source: static:X
    condition_field: form.financing_fha
    condition_equals: "yes"

  - field_key: financing_other
    docuseal_field: "Financing options (other)"
    role_key: system
    source: static:X
    condition_field: form.financing_other
    condition_equals: "yes"

  - field_key: financing_cash
    docuseal_field: "Financing options (Cash)"
    role_key: system
    source: static:X
    condition_field: form.financing_cash
    condition_equals: "yes"

  - field_key: financing_tx_vet
    docuseal_field: "Financing options (Texas Veterans Land)"
    role_key: system
    source: static:X
    condition_field: form.financing_tx_vet
    condition_equals: "yes"

  # --- Seller Representations (pg8) ---
  - field_key: seller_rep_delinquent
    docuseal_field: "Seller Representation (delinquent loans, taxes, or HOA)"
    role_key: system
    source: form.delinquencies_explanation

  - field_key: seller_rep_liens
    docuseal_field: "Seller Representation (Liens)"
    role_key: system
    source: form.liens_explanation

  - field_key: special_taxing_districts
    docuseal_field: "special taxing districts detail"
    role_key: system
    source: form.special_districts_list

  # --- Special Provisions (pg9) ---
  - field_key: special_provisions_text
    docuseal_field: "Special Provisions Text"
    role_key: system
    source: form.special_provisions

  # --- Printed Names/License (pg11) ---
  - field_key: broker_printed_name
    docuseal_field: "Broker printed name"
    role_key: system
    source: static:Origen Realty

  - field_key: broker_license_number
    docuseal_field: "Broker license number"
    role_key: system
    source: static:9003104

  - field_key: seller_1_printed_name
    docuseal_field: "Seller 1 printed name"
    role_key: system
    source: form.seller_legal_name

  - field_key: agent_printed_name
    docuseal_field: "Agent printed name"
    role_key: system
    source: user.full_name

  - field_key: agent_license_number
    docuseal_field: "Agent license number"
    role_key: system
    source: user.license_number

  # --- System-assigned Seller 2 initials (pg10) - template anomaly ---
  - field_key: seller_2_initials_pg10
    docuseal_field: "Seller 2 Initials pg 10"
    role_key: system
    source: null

# =============================================================================
# FIELDS - Seller Role (19 fields)
# =============================================================================
  # --- Pre-populated readonly text (6 fields) ---
  - field_key: seller_1_name
    docuseal_field: "Seller 1 name"
    role_key: seller
    source: form.seller_legal_name

  - field_key: seller_address
    docuseal_field: "Seller address"
    role_key: seller
    source: form.property_address

  - field_key: seller_city_state_zip
    docuseal_field: "Seller city/state/zip"
    role_key: seller
    sources:
      - form.property_city
      - form.property_state
      - form.property_zip
    template: "{0}, {1} {2}"

  - field_key: seller_phone
    docuseal_field: "Seller phone"
    role_key: seller
    source: form.seller_phone
    transform: phone

  - field_key: seller_email_fax
    docuseal_field: "Seller email/fax"
    role_key: seller
    source: form.seller_email

  - field_key: seller_email_fax_2
    docuseal_field: "Seller email/fax 2"
    role_key: seller
    source: null

  # --- Manual entry during signing (13 fields) ---
  - field_key: seller_1_initials_pg1
    docuseal_field: "Seller 1 Initials pg 1"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg2
    docuseal_field: "Seller 1 Initials pg 2"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg3
    docuseal_field: "Seller 1 Initials pg 3"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg4
    docuseal_field: "Seller 1 Initials pg 4"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg5
    docuseal_field: "Seller 1 Initials pg 5"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg6
    docuseal_field: "Seller 1 Initials pg 6"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg7
    docuseal_field: "Seller 1 Initials pg 7"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg8
    docuseal_field: "Seller 1 Initials pg 8"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg9
    docuseal_field: "Seller 1 Initials pg 9"
    role_key: seller
    source: null

  - field_key: seller_1_initials_pg10
    docuseal_field: "Seller 1 Initials pg 10"
    role_key: seller
    source: null

  - field_key: foreign_person
    docuseal_field: "Foreign person"
    role_key: seller
    source: null

  - field_key: seller_signature_date
    docuseal_field: "Seller Signature Date"
    role_key: seller
    source: null

  - field_key: seller_signature
    docuseal_field: "Seller Signature"
    role_key: seller
    source: null

# =============================================================================
# FIELDS - Seller 2 Role (13 fields) - Optional
# =============================================================================
  # --- Pre-populated readonly text (2 fields) ---
  - field_key: seller_2_name
    docuseal_field: "Seller 2 Name"
    role_key: seller_2
    source: transaction.sellers[1].display_name

  - field_key: seller_2_printed_name
    docuseal_field: "Seller 2 printed name"
    role_key: seller_2
    source: transaction.sellers[1].display_name

  # --- Manual entry during signing (11 fields) ---
  - field_key: seller_2_initials_pg1
    docuseal_field: "Seller 2 Initials pg 1"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg2
    docuseal_field: "Seller 2 Initials pg 2"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg3
    docuseal_field: "Seller 2 Initials pg 3"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg4
    docuseal_field: "Seller 2 Initials pg 4"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg5
    docuseal_field: "Seller 2 Initials pg 5"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg6
    docuseal_field: "Seller 2 Initials pg 6"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg7
    docuseal_field: "Seller 2 Initials pg 7"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg8
    docuseal_field: "Seller 2 Initials pg 8"
    role_key: seller_2
    source: null

  - field_key: seller_2_initials_pg9
    docuseal_field: "Seller 2 Initials pg 9"
    role_key: seller_2
    source: null

  - field_key: seller_2_signature_date
    docuseal_field: "Seller 2 Signature Date"
    role_key: seller_2
    source: null

  - field_key: seller_2_signature
    docuseal_field: "Seller 2 Signature"
    role_key: seller_2
    source: null

# =============================================================================
# FIELDS - Broker Role (31 fields) - Agent signs manually
# =============================================================================
  - field_key: broker_initials_pg1
    docuseal_field: "Broker initials pg 1"
    role_key: broker
    source: null

  - field_key: broker_initials_pg2
    docuseal_field: "Broker initials pg 2"
    role_key: broker
    source: null

  - field_key: broker_initials_pg3
    docuseal_field: "Broker initials pg 3"
    role_key: broker
    source: null

  - field_key: broker_initials_pg4
    docuseal_field: "Broker initials pg 4"
    role_key: broker
    source: null

  - field_key: broker_initials_pg5
    docuseal_field: "Broker initials pg 5"
    role_key: broker
    source: null

  - field_key: broker_initials_pg6
    docuseal_field: "Broker initials pg 6"
    role_key: broker
    source: null

  - field_key: broker_initials_pg7
    docuseal_field: "Broker initials pg 7"
    role_key: broker
    source: null

  - field_key: broker_initials_pg8
    docuseal_field: "Broker initials pg 8"
    role_key: broker
    source: null

  - field_key: broker_initials_pg9
    docuseal_field: "Broker initials pg 9"
    role_key: broker
    source: null

  - field_key: broker_initials_pg10
    docuseal_field: "Broker initials pg 10"
    role_key: broker
    source: null

  - field_key: include_brokerage_services
    docuseal_field: "Include Brokerage Services info"
    role_key: broker
    source: null

  - field_key: include_seller_disclosure
    docuseal_field: "Include Seller Disclosure Notice"
    role_key: broker
    source: null

  - field_key: lead_based_paint_addendum
    docuseal_field: "Lead‑Based Paint addendum"
    role_key: broker
    source: null

  - field_key: t47_affidavit
    docuseal_field: "T‑47 Affidavit"
    role_key: broker
    source: null

  - field_key: mud_water_district
    docuseal_field: "MUD/Water District notice"
    role_key: broker
    source: null

  - field_key: pid_disclosure
    docuseal_field: "PID Disclosure"
    role_key: broker
    source: null

  - field_key: owners_association_request
    docuseal_field: "Owners' Association request"
    role_key: broker
    source: null

  - field_key: mortgage_information_request
    docuseal_field: "Mortgage information request"
    role_key: broker
    source: null

  - field_key: mineral_clause_info
    docuseal_field: "Mineral clause info"
    role_key: broker
    source: null

  - field_key: onsite_sewer_info
    docuseal_field: "On‑Site Sewer info"
    role_key: broker
    source: null

  - field_key: property_insurance_info
    docuseal_field: "Property insurance info"
    role_key: broker
    source: null

  - field_key: special_flood_hazard_info
    docuseal_field: "Special Flood Hazard info"
    role_key: broker
    source: null

  - field_key: condominium_addendum
    docuseal_field: "Condominium addendum"
    role_key: broker
    source: null

  - field_key: keybox_tenant_authorization
    docuseal_field: "Keybox tenant authorization"
    role_key: broker
    source: null

  - field_key: disclose_advertise_info
    docuseal_field: "Disclose/advertise info"
    role_key: broker
    source: null

  - field_key: agent_signature
    docuseal_field: "Agent Signature"
    role_key: broker
    source: null

  - field_key: broker_license_number_2
    docuseal_field: "Broker license number 2"
    role_key: broker
    source: null
